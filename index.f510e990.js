const e=new class{constructor(e){this.board=e||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="idle",this.addRandomTile(),this.addRandomTile()}moveLeft(){this.move(0,-1)&&(this.addRandomTile(),this.checkGameStatus())}moveRight(){this.move(0,1)&&(this.addRandomTile(),this.checkGameStatus())}moveUp(){this.move(-1,0)&&(this.addRandomTile(),this.checkGameStatus())}moveDown(){this.move(1,0)&&(this.addRandomTile(),this.checkGameStatus())}getScore(){return this.score}getState(){return this.board}getStatus(){return this.status}start(){this.status="playing",this.addRandomTile()}restart(){this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="playing",this.addRandomTile(),this.addRandomTile()}move(e,t){let s=!1,o=[],a=(e,t)=>e>=0&&e<4&&t>=0&&t<4;return(()=>{let r=[0,1,2,3],i=[0,1,2,3];for(let d of(1===e&&r.reverse(),1===t&&i.reverse(),r))for(let r of i){let i=this.board[d][r];if(0===i)continue;let n=d,c=r;for(;a(n+e,c+t)&&0===this.board[n+e][c+t];)n+=e,c+=t;a(n+e,c+t)&&this.board[n+e][c+t]===i&&!o.includes(`${n+e}-${c+t}`)?(this.board[n+e][c+t]*=2,this.board[d][r]=0,o.push(`${n+e}-${c+t}`),this.score+=this.board[n+e][c+t],s=!0):(n!==d||c!==r)&&(this.board[n][c]=i,this.board[d][r]=0,s=!0)}})(),s}addRandomTile(){let e=[];for(let t=0;t<4;t++)for(let s=0;s<4;s++)0===this.board[t][s]&&e.push([t,s]);if(e.length>0){let[t,s]=e[Math.floor(Math.random()*e.length)];this.board[t][s]=.9>Math.random()?2:4}}checkGameStatus(){this.board.some(e=>e.includes(2048))?this.status="win":this.canMove()||(this.status="lose")}canMove(){for(let e=0;e<4;e++)for(let t=0;t<4;t++)if(0===this.board[e][t]||e<3&&this.board[e][t]===this.board[e+1][t]||t<3&&this.board[e][t]===this.board[e][t+1])return!0;return!1}};function t(){let t=e.getState();document.querySelectorAll(".field-cell").forEach((e,s)=>{let o=t[Math.floor(s/4)][s%4];e.innerText=0===o?"":o,e.className=`field-cell ${o?`field-cell--${o}`:""}`})}function s(){document.querySelector(".game-score").innerText=e.getScore()}function o(e){document.querySelector(".message-start").classList.add("hidden"),document.querySelector(".message-win").classList.add("hidden"),document.querySelector(".message-lose").classList.add("hidden"),"win"===e?document.querySelector(".message-win").classList.remove("hidden"):"lose"===e&&document.querySelector(".message-lose").classList.remove("hidden")}document.addEventListener("keydown",function(a){if("playing"===e.getStatus()){switch(a.key){case"ArrowUp":e.moveUp();break;case"ArrowDown":e.moveDown();break;case"ArrowLeft":e.moveLeft();break;case"ArrowRight":e.moveRight()}t(),s(),"win"===e.getStatus()?o("win"):"lose"===e.getStatus()&&o("lose")}}),document.querySelector(".start").addEventListener("click",function(){e.restart(),t(),s(),o("start"),document.querySelector(".start").classList.remove("start"),document.querySelector(".button").classList.add("restart"),document.querySelector(".button").innerText="Restart"});
//# sourceMappingURL=index.f510e990.js.map
